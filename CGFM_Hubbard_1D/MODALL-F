	MODULE PRINCIPAL
	  INTEGER, PARAMETER :: NBMAX=128
	  INTEGER :: ICHARX,IU1X,IZI,P,PP,PPP,L,LL,LLL
	  REAL(KIND=KIND(1.0D0)) ::ACOPUI,ACOPnI,ACOPtI,BETAI,AMUI,ACOPVI
	  REAL(KIND=KIND(1.0D0)) ::ACOPU,ACOPn,ACOPt,ACOPU1,ACOPU2,ACOPV,ACOPH
	  REAL(KIND=KIND(1.0D0)) ::ACPIHM,ACPI
          INTEGER(KIND=KIND(1.0D0)), DIMENSION(:,:), ALLOCATABLE :: V,VV,VVV,S,SS,SSS

	  INTEGER :: LFIN,LAT,ITDIM,LBL,ICONT,IDOWN

	  REAL(KIND=KIND(1.0D0)) :: PI,EMIN,BETA,D,AMU
!*-> ACJ
	  REAL(KIND=KIND(1.0D0)), DIMENSION(14):: ACN,ACU,ACS,ACt
	  
	  
	  INTEGER :: NBL1H,NBL2H
	  INTEGER :: NBL1CUP,NBL2CUP
	  INTEGER :: NBL1CDOWN,NBL2CDOWN
!*-> A2H
	  INTEGER, DIMENSION(NBMAX) :: ICHARB1,ICHARB2

	  INTEGER, DIMENSION(NBMAX) :: IU1B1,IU1B2

	  INTEGER, DIMENSION(NBMAX) :: IDIMB1H,IDIMB2H
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB1I,IPOSIB2I

!*-> A2CUP
	  INTEGER, DIMENSION(2,NBMAX) :: IDIMB1CUP,IDIMB2CUP
	  INTEGER, DIMENSION(NBMAX) :: ICHARB1XCUP,ICHARB2XCUP 
	  INTEGER, DIMENSION(NBMAX) :: ICHARB1YCUP,ICHARB2YCUP
	  INTEGER, DIMENSION(NBMAX) :: IU1B1XCUP,IU1B2XCUP
	  INTEGER, DIMENSION(NBMAX) :: IU1B1YCUP,IU1B2YCUP
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB1XCUP,IPOSIB1YCUP
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB2XCUP,IPOSIB2YCUP
 
!	  INTEGER, DIMENSION(7,NBMAX,100,100) :: IIDUPLA,IISIMPLE
	  INTEGER, DIMENSION(2,1,1) :: IIDUPLA2,IISIMPLE2,FFDUPLA2,FFSIMPLE2
	  
!*-> A2CDOWN
	  INTEGER, DIMENSION(2,NBMAX) :: IDIMB1CDOWN,IDIMB2CDOWN

	  INTEGER, DIMENSION(NBMAX) :: ICHARB1XCDOWN,ICHARB2XCDOWN

	  INTEGER, DIMENSION(NBMAX) :: ICHARB1YCDOWN,ICHARB2YCDOWN

	  INTEGER, DIMENSION(NBMAX) :: IU1B1XCDOWN,IU1B2XCDOWN

	  INTEGER, DIMENSION(NBMAX) :: IU1B1YCDOWN,IU1B2YCDOWN
	  
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB1XCDOWN,IPOSIB1YCDOWN
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB2XCDOWN,IPOSIB2YCDOWN
!*-> AHSIS
	  INTEGER :: NBL1HSIS,NBBIG

	  INTEGER, DIMENSION(NBMAX) :: ICHARB1SIS,IU1B1SIS
	  INTEGER, DIMENSION(NBMAX) :: IDIMB1HSIS,IPOSIB1ISIS

!*-> ACUPSIS
	  INTEGER :: NBL1CUPSIS

	  INTEGER, DIMENSION(2,NBMAX) :: IDIMB1CUPSIS

	  INTEGER, DIMENSION(NBMAX) :: ICHARB1XCUPSIS,ICHARB1YCUPSIS
	  INTEGER, DIMENSION(NBMAX) :: IU1B1XCUPSIS,IU1B1YCUPSIS
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB1XCUPSIS,IPOSIB1YCUPSIS

!*-> ACDOWNSIS
	  INTEGER :: NBL1CDOWNSIS

	  INTEGER, DIMENSION(2,NBMAX) :: IDIMB1CDOWNSIS

	  INTEGER, DIMENSION(NBMAX) :: ICHARB1XCDOWNSIS,ICHARB1YCDOWNSIS
	  INTEGER, DIMENSION(NBMAX) :: IU1B1XCDOWNSIS,IU1B1YCDOWNSIS
	  INTEGER, DIMENSION(NBMAX) :: IPOSIB1XCDOWNSIS,IPOSIB1YCDOWNSIS

!*-> ACONEC
	  INTEGER, DIMENSION(4) :: IB2CUPX,IB2CUPY,IB2CDOWNX
	  INTEGER, DIMENSION(4) :: IB2CDOWNY

	  INTEGER, DIMENSION(NBMAX) :: IB1CUPX,IB1CUPY,IB1CDOWNX
	  INTEGER, DIMENSION(NBMAX) :: IB1CDOWNY

	  
          INTEGER, DIMENSION(NBMAX) ::INVHCUPSISX,IXHCUPSIS,IYHCUPSIS,IXHCDOWNSIS,IYHCDOWNSIS,IBHUSED
          INTEGER, DIMENSION(NBMAX) ::IB1CUPSISX,IB1CUPSISY,IB1CDOWNSISX,IB1CDOWNSISY,INVHCDOWNSISX
	  
!*->AIP
	  INTEGER, DIMENSION(1000) ::  IP
	  INTEGER, DIMENSION(NBMAX) :: INBS,INBU

	END MODULE PRINCIPAL
!*----------------------------------------------------------------------------------
	MODULE TYPE_OP1
	 TYPE OPERATOR
	  REAL(KIND=KIND(1.0D0)),DIMENSION(:,:),POINTER::op
	 END TYPE OPERATOR         
	END MODULE TYPE_OP1


	MODULE TYPE_OP2
	 TYPE OPERATOR2
	  INTEGER,DIMENSION(:,:,:,:),POINTER::op2
	 END TYPE OPERATOR2
	END MODULE TYPE_OP2          


	MODULE TYPE_OP3
	  TYPE OPERATOR3
           REAL(KIND=KIND(1.0D0)),DIMENSION(:),POINTER::op3
          END TYPE OPERATOR3
	END MODULE TYPE_OP3  

	MODULE TYPE_OP4
	 TYPE OPERATOR4
	  INTEGER,DIMENSION(:,:),POINTER::op4
	 END TYPE OPERATOR4
	END MODULE TYPE_OP4

	MODULE TYPE_OP5
	 TYPE OPERATOR5
	  INTEGER,DIMENSION(:),POINTER::op5
	 END TYPE OPERATOR5
	END MODULE TYPE_OP5
	
	MODULE TYPE_OP6
	 TYPE OPERATOR6
	  REAL(KIND=KIND(1.0D0)),DIMENSION(:,:,:,:),POINTER::op6
	 END TYPE OPERATOR6
	END MODULE TYPE_OP6 
!*--->
!*-->
	MODULE AMODOLO
	USE PRINCIPAL
	USE TYPE_OP1

	TYPE(OPERATOR), DIMENSION(NBMAX):: XLU,XLN,CUPL,CDOWNL,XLH
	TYPE(OPERATOR), DIMENSION(NBMAX):: CUPS,CUPD,CDOWNS,CDOWND
	END MODULE AMODOLO
!*------->
	MODULE AMODESP1
	USE PRINCIPAL
	USE TYPE_OP1

	TYPE(OPERATOR), DIMENSION(NBMAX):: HB1,ACUP,ACDOWN,ANN
	TYPE(OPERATOR), DIMENSION(NBMAX):: BCUP,BCDOWN

	END MODULE AMODESP1
!*--->
	MODULE AMODESP2
	USE PRINCIPAL
	USE TYPE_OP1

	TYPE(OPERATOR), DIMENSION(NBMAX)::CUP2,CDOWN2,X2

	END MODULE AMODESP2
!*-->
	MODULE AMODIGSIS
	USE PRINCIPAL
	USE TYPE_OP4
	USE TYPE_OP5

	TYPE(OPERATOR4), DIMENSION(1):: IGOLD
	TYPE(OPERATOR4), DIMENSION(NBMAX,4):: IGSIS
	TYPE(OPERATOR4), DIMENSION(NBMAX):: IDUTEM,ISITEM
	TYPE(OPERATOR4), DIMENSION(NBMAX):: ITSIM,ITDUP
!	TYPE(OPERATOR4), DIMENSION(NBMAX):: IDU,ISI
!	TYPE(OPERATOR5), DIMENSION(NBMAX):: INVSIS1A,INVSIS1B
!	TYPE(OPERATOR5), DIMENSION(NBMAX):: INVSIS2A,INVSIS2B

	END MODULE AMODIGSIS
!*-->
	MODULE AMODO
	USE PRINCIPAL
	USE TYPE_OP1
	USE TYPE_OP3

	TYPE(OPERATOR), DIMENSION(NBMAX):: OS
	TYPE(OPERATOR3), DIMENSION(NBMAX):: WPHOS

	END MODULE AMODO
	
	
!*-->
	MODULE FGREEN
	USE PRINCIPAL
	USE TYPE_OP1
	USE TYPE_OP6
!	REAL(KIND=KIND(1.0D0)), DIMENSION(:,:,:,:), ALLOCATABLE :: M11,M33,M13
	TYPE(OPERATOR), DIMENSION(NBMAX,NBMAX)::M11,M33,M13
	REAL(KIND=KIND(1.0D0)), DIMENSION(12) :: DM11,DM13,DM33,DUT
!	COMPLEX(KIND=KIND(1.0D0)) :: ZGFAT11,ZGFAT13,ZGFAT33,ZWD
!	REAL(KIND=KIND(1.0D0)) :: RENOR
	TYPE(OPERATOR6), DIMENSION(9):: T11,T33,T13
	END MODULE FGREEN
!*-->
	MODULE AMODHSIS
	USE PRINCIPAL
	USE TYPE_OP1
	USE TYPE_OP3
	
	TYPE(OPERATOR), DIMENSION(NBMAX):: HSIS,CDES1,CG33,CG11,CG13,CUPK,CUPW
	TYPE(OPERATOR), DIMENSION(NBMAX):: CG44,CG22,CG24
!	TYPE(OPERATOR), DIMENSION(10,NBMAX):: CKILL
!	TYPE(OPERATOR3), DIMENSION(NBMAX):: VT
	END MODULE AMODHSIS
!*-->


